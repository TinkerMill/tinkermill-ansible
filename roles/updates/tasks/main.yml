---
# tasks file for updates

# Configure apt proxy:
- name: Point APT to PFSense Proxy
  lineinfile: 
    create: yes
    dest: /etc/apt/apt.conf
    group: root
    line: Acquire::http::Proxy "http://{{ pfsense_proxy_host }}:{{ pfsense_proxy_port }}";
    mode: 0644
    owner: root
    state: present
  tags:
    - updates
    - files  

# Update apt cache:
- name: Update APT cache
  apt: 
    cache_valid_time: 3600
    update_cache: yes
  tags:
    - updates
    - packages

# Apply updates:
- name: Apply available updates
  apt: 
    cache_valid_time: 3600
    upgrade: full
  tags:
    - updates
    - packages
